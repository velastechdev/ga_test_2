name: ¿Con qué tanta antelación te está agendando un paciente las citas?
description: null
entity_id: D4GC8RajMVmKKHMFW8xZ2
created_at: '2025-01-24T17:33:16.541778Z'
creator_id: christopher.diaz@huli.io
display: scalar
archived: false
collection_id: db6CZcw2qxnVMxe2VJtbr
collection_preview: true
collection_position: null
query_type: native
database_id: Data WareHouse (PROD)
table_id: null
enable_embedding: false
embedding_params: null
made_public_by_id: null
public_uuid: null
parameters:
- default: '0'
  id: 7b3433b5-10b0-4497-91d5-c2a1bb615d29
  name: Organization ID
  slug: organization_id
  target:
  - variable
  - - template-tag
    - organization_id
  type: number/=
- id: 9cb94ce7-1e62-43fe-a745-e7f14459eee1
  name: Date Range
  slug: date_range
  target:
  - dimension
  - - template-tag
    - date_range
  type: date/range
- id: 1632d00c-87c8-45bb-be67-028495efc98e
  name: Patient Sex
  slug: patient_sex
  target:
  - variable
  - - template-tag
    - patient_sex
  type: category
  values_query_type: list
  values_source_config:
    values:
    - - M
      - Hombre
    - - F
      - Mujer
  values_source_type: static-list
- id: f3d44d61-3f11-4582-9122-6c490e870949
  name: Tags
  slug: tags
  target:
  - dimension
  - - template-tag
    - tags
  type: string/=
  values_source_config:
    card_id: JWLh-RI5Vs3LJfdcF369Y
    value_field:
    - field
    - - Data WareHouse (PROD)
      - huli_main_aurora_result
      - appointment
      - tags
    - base-type: type/Text
  values_source_type: card
- id: 108318f3-2c66-4922-bfcc-3466aa6dcd1b
  name: Clinc Name
  slug: clinc_name
  target:
  - dimension
  - - template-tag
    - clinc_name
  type: string/=
  values_source_config:
    card_id: q61cd1kHGOwE6yS9vCA8J
    value_field:
    - field
    - - Data WareHouse (PROD)
      - huli_main_aurora_result
      - appointment
      - clinic_name
    - base-type: type/Text
  values_source_type: card
- id: f00ce1c0-9a3c-44ba-b8a7-8d9119b2d17c
  name: Is Confirmed
  slug: is_confirmed
  target:
  - variable
  - - template-tag
    - is_confirmed
  type: category
  values_query_type: list
  values_source_config:
    values:
    - - '1'
      - Sí
    - - '0'
      - 'No'
  values_source_type: static-list
- id: af349a0e-f505-420b-a0b3-b72a90d7fa15
  name: Age Range
  slug: age_range
  target:
  - variable
  - - template-tag
    - age_range
  type: category
  values_query_type: list
  values_source_config:
    card_id: sDuY37zfnB7TeVmDsQAWE
    value_field:
    - field
    - age_group
    - base-type: type/Text
  values_source_type: card
parameter_mappings: []
dataset_query:
  database: Data WareHouse (PROD)
  native:
    query: "SELECT \n  CONCAT(\n    CAST(\n      ROUND(\n        COALESCE(\n          AVG(days_diff), 0\n        ), \n        1\n      ) AS STRING\n    ), \n    ' días'\n  ) AS average_days_difference\nFROM (\n  SELECT \n    DATE_DIFF(DATE(`start_date`), DATE(`created_on_user_tz`), DAY) AS days_diff,\n    {{snippet: field_age_range}},\n  FROM \n    `huli_main_aurora_result.appointment`\n  WHERE \n    `start_date` IS NOT NULL \n    AND `created_on_user_tz` IS NOT NULL\n    AND `organization_id` = {{ organization_id }}\n    AND `appointment_status` = 'completed'\n    [[ AND {{ date_range }} ]]\n    [[ AND `patient_sex` = {{ patient_sex }} ]]\n    [[ AND {{ tags }} ]]\n    [[ AND {{ clinc_name }} ]]\n    [[ AND `is_confirmed` = CAST({{ is_confirmed }} AS INT64) ]]\n) subquery\nWHERE 1 = 1\n    [[ AND Rango_de_edad IN ({{ age_range }}) ]]\n"
    template-tags:
      age_range:
        display-name: Age Range
        id: af349a0e-f505-420b-a0b3-b72a90d7fa15
        name: age_range
        type: text
      clinc_name:
        default: null
        dimension:
        - field
        - - Data WareHouse (PROD)
          - huli_main_aurora_result
          - appointment
          - clinic_name
        - null
        display-name: Clinc Name
        id: 108318f3-2c66-4922-bfcc-3466aa6dcd1b
        name: clinc_name
        options: null
        type: dimension
        widget-type: string/=
      date_range:
        default: null
        dimension:
        - field
        - - Data WareHouse (PROD)
          - huli_main_aurora_result
          - appointment
          - start_date
        - null
        display-name: Date Range
        id: 9cb94ce7-1e62-43fe-a745-e7f14459eee1
        name: date_range
        options: null
        type: dimension
        widget-type: date/range
      is_confirmed:
        display-name: Is Confirmed
        id: f00ce1c0-9a3c-44ba-b8a7-8d9119b2d17c
        name: is_confirmed
        type: text
      organization_id:
        default: '0'
        display-name: Organization ID
        id: 7b3433b5-10b0-4497-91d5-c2a1bb615d29
        name: organization_id
        type: number
        widget-type: null
      patient_sex:
        display-name: Patient Sex
        id: 1632d00c-87c8-45bb-be67-028495efc98e
        name: patient_sex
        type: text
      'snippet: field_age_range':
        display-name: 'Snippet: Field Age Range'
        id: b0513edd-9b73-446d-abff-4dde5d33a17f
        name: 'snippet: field_age_range'
        snippet-id: TbowWUOLnLZKAesaYd15I
        snippet-name: field_age_range
        type: snippet
      tags:
        default: null
        dimension:
        - field
        - - Data WareHouse (PROD)
          - huli_main_aurora_result
          - appointment
          - tags
        - null
        display-name: Tags
        id: f3d44d61-3f11-4582-9122-6c490e870949
        name: tags
        options: null
        type: dimension
        widget-type: string/=
  type: native
result_metadata:
- base_type: type/Text
  display_name: average_days_difference
  effective_type: type/Text
  field_ref:
  - field
  - average_days_difference
  - base-type: type/Text
  name: average_days_difference
  semantic_type: null
visualization_settings:
  column_settings: null
  table.pivot_column: average_days_difference
serdes/meta:
- id: D4GC8RajMVmKKHMFW8xZ2
  label: ¿con_que_tanta_antelacion_te_esta_agendando_un_paciente_las_citas_
  model: Card
archived_directly: false
metabase_version: v1.51.6 (fc77ed4)
source_card_id: null
type: question
